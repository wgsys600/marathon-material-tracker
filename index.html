<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marathon Material Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #111; color: #eee; }
        input[type="text"] { width: 100%; padding: 10px; font-size: 16px; margin-bottom: 20px; }
        .material { margin: 10px 0; padding: 10px; background: #222; border-radius: 5px; }
        .material label { cursor: pointer; }
        #trackingList { margin-top: 30px; }
        button { margin-top: 10px; padding: 5px 10px; font-size: 14px; }
    </style>
</head>
<body>

<h1>Marathon Material Tracker</h1>
<input type="text" id="searchInput" placeholder="Search for a material...">
<div id="materialsList"></div>

<h2>ðŸ“‹ Currently Tracking:</h2>
<ul id="trackingList"></ul>
<button onclick="clearTracking()">Clear All</button>

<script>
let materials = [];
const searchInput = document.getElementById('searchInput');
const materialsList = document.getElementById('materialsList');
const trackingList = document.getElementById('trackingList');
let trackingItems = JSON.parse(localStorage.getItem('trackingItems')) || [];

fetch('materials.json')
    .then(response => response.json())
    .then(data => {
        materials = data;
        renderMaterials();
        renderTracking();
    });

function renderMaterials() {
    const query = searchInput.value.toLowerCase();
    materialsList.innerHTML = '';
    materials
        .filter(m => m.Material.toLowerCase().includes(query))
        .forEach((m) => {
            const div = document.createElement('div');
            div.className = 'material';
            const checked = trackingItems.includes(m.Material) ? 'checked' : '';
            div.innerHTML = `
                <label>
                    <input type="checkbox" onchange="toggleTracking('${m.Material}')" ${checked}>
                    <strong>${m.Material}</strong> <br>
                    Map: ${m.Map} | POI 1: ${m["POI 1"]} | POI 2: ${m["POI 2"]}<br>
                    Sources: ${[m["Source 1"], m["Source 2"], m["Source 3"]].filter(s => s).join(", ")}<br>
                    Notes: ${m.Notes || 'None'}
                </label>
            `;
            materialsList.appendChild(div);
        });
}

function toggleTracking(material) {
    if (trackingItems.includes(material)) {
        trackingItems = trackingItems.filter(m => m !== material);
    } else {
        trackingItems.push(material);
    }
    localStorage.setItem('trackingItems', JSON.stringify(trackingItems));
    renderTracking();
    renderMaterials();
}

function renderTracking() {
    trackingList.innerHTML = '';
    trackingItems.forEach(m => {
        const li = document.createElement('li');
        li.textContent = m;
        trackingList.appendChild(li);
    });
}

function clearTracking() {
    trackingItems = [];
    localStorage.removeItem('trackingItems');
    renderTracking();
    renderMaterials();
}

searchInput.addEventListener('input', renderMaterials);
</script>

</body>
</html>
